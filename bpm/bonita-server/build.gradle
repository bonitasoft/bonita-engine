import org.bonitasoft.engine.gradle.ShadeDependency

apply plugin: 'bonita-shade'

dependencies {
    compile project(':engine:bpm:bonita-core:bonita-process-engine')
    compile project(':engine:services:bonita-builder')
    compile project(':engine:bpm:bonita-core:bonita-actor-mapping')
    compile project(':engine:bpm:bonita-api:bonita-server-api-http')
    compile project(':engine:services:bonita-archive')
    compile project(':engine:services:bonita-authentication')
    compile project(':engine:services:bonita-business-application:bonita-business-application-api')
    compile project(':engine:services:bonita-business-application:bonita-business-application-impl')
    compile project(':engine:services:bonita-business-data:bonita-business-data-impl')
    compile project(':engine:services:bonita-business-data:bonita-business-data-client-resources')
    compile project(':engine:services:bonita-business-data:bonita-business-data-generator')
    compile project(':engine:services:bonita-cache')
    compile project(':engine:bpm:bonita-core:bonita-category')
    compile project(':engine:services:bonita-classloader')
    compile project(':engine:services:bonita-command')
    compile project(':engine:bpm:bonita-core:bonita-contract-data')
    compile project(':engine:services:bonita-connector-executor')
    compile project(':engine:services:bonita-data-definition')
    compile project(':engine:services:bonita-data-instance')
    compile project(':engine:services:bonita-dependency')
    compile project(':engine:services:bonita-events')
    compile project(':engine:services:bonita-expression')
    compile project(':engine:services:bonita-external-identity-mapping')
    compile project(':engine:bpm:bonita-core:bonita-form-mapping')
    compile project(':engine:services:bonita-incident')
    compile project(':engine:services:bonita-identity')
    compile project(':engine:services:bonita-lock')
    compile project(':engine:bpm:bonita-core:bonita-login')
    compile project(':engine:services:bonita-log')
    compile project(':engine:services:bonita-page')
    compile project(':engine:bpm:bonita-core:bonita-parameter')
    compile project(':engine:services:bonita-persistence')
    compile project(':engine:services:bonita-platform')
    compile project(':engine:services:bonita-platform-authentication')
    compile project(':engine:services:bonita-platform-command')
    compile project(':engine:bpm:bonita-core:bonita-platform-login')
    compile project(':engine:services:bonita-platform-session')
    compile project(':engine:bpm:bonita-core:bonita-process-comment')
    compile project(':engine:bpm:bonita-core:bonita-process-definition')
    compile project(':engine:bpm:bonita-core:bonita-process-instance')
    compile project(':engine:services:bonita-recorder')
    compile project(':engine:services:bonita-scheduler')
    compile project(':engine:services:bonita-session')
    compile project(':engine:bpm:bonita-core:bonita-supervisor-mapping')
    compile project(':engine:bpm:bonita-synchro-repository:bonita-synchro-service')
    compile project(':engine:bpm:bonita-synchro-repository:bonita-synchro-service-impl')
    compile project(':engine:bpm:bonita-synchro-repository:bonita-synchro-register')
    compile project(':engine:services:bonita-time-tracker')
    compile project(':engine:services:bonita-transaction')
    compile project(':engine:bpm:bonita-core:bonita-core-data')
    compile project(':engine:services:bonita-log-technical')
    compile project(':engine:bpm:bonita-core:bonita-user-filter')
    compile project(':engine:services:bonita-work')
    compile project(':engine:bpm:bonita-external')
    compile project(':engine:services:bonita-profile')
    compile project(':engine:services:bonita-theme')
    compile project(':engine:bpm:bonita-common')
}

shade {
    exclude project(':engine:bpm:bonita-common')
    exclude project(':engine:platform:platform-resources')

    excludeLibs('hibernate-core', new ShadeDependency(group: 'org.jboss.spec.javax.transaction', name: 'jboss-transaction-api_1.2_spec'))
    excludeLibs('hibernate-entitymanager', new ShadeDependency(group: 'org.jboss.spec.javax.transaction', name: 'jboss-transaction-api_1.2_spec'))
}

afterEvaluate {
    publishing {
        publications {
            shadow(MavenPublication) { publication ->
                publication.getPom().with {
                    name = "Bonita Server"
                    description = "Bonita Server is the Server-side BPM Execution Engine"
                }
            }
        }
    }
}