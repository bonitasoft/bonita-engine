<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:hz="http://www.hazelcast.com/schema/spring"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd ">
	<!-- configure the instance named bonita,it is the default instance used 
		by bonita -->

	<!-- the factory with start stop method that returns the hazelcast instance -->
	<bean id="hazelcastService" class="com.bonitasoft.engine.service.impl.BonitaHazelcastInstanceFactory" scope="singleton" destroy-method="destroy"></bean>

	<bean id="hazelcastInstance"
		factory-bean="hazelcastService"
		factory-method="newHazelcastInstance" scope="singleton" >
		<constructor-arg>
			<bean class="com.hazelcast.config.Config">
				<property name="groupConfig">
					<bean class="com.hazelcast.config.GroupConfig">
						<property name="name" value="${bonita.cluster.group.name:bonita}" />
						<property name="password" value="${bonita.cluster.group.password:bpm}" />
					</bean>
				</property>
				<!-- Disable the hazelcast shutdown hook because we handle the shutdown ourself -->
				<property name="properties">
					<props>
      					<prop key="hazelcast.shutdownhook.enabled">false</prop>
    				</props>
            	</property>
				<property name="instanceName" value="bonita" />
				<property name="networkConfig">
					<bean class="com.hazelcast.config.NetworkConfig">
						<property name="join">
							<bean class="com.hazelcast.config.JoinConfig">
								<property name="multicastConfig">
									<bean class="com.hazelcast.config.MulticastConfig">
										<property name="enabled" value="true" />
										<property name="multicastGroup" value="224.2.2.3" />
										<property name="multicastPort" value="54327" />
									</bean>
								</property>
							</bean>
						</property>
						<property name="interfaces">
							<bean class="com.hazelcast.config.InterfacesConfig">
								<property name="interfaces">
									<list>
										<value>127.0.0.1</value>
									</list>
								</property>
							</bean>
						</property>
					</bean>
				</property>
				<!-- <property name="serializationConfig"> -->
				<!-- <bean class="com.hazelcast.config.SerializationConfig"> -->
				<!-- <property name="serializerConfigs"> -->
				<!-- <list> -->
				<!-- <bean class="com.hazelcast.config.SerializerConfig"> -->
				<!-- <property name="className" value="com.bonitasoft.engine.classloader.BonitaSerializer"/> -->
				<!-- <property name="typeClassName" value="org.bonitasoft.engine.commons.BonitaSerializable"/> -->
				<!-- </bean> -->
				<!-- </list> -->
				<!-- </property> -->
				<!-- </bean> -->
				<!-- </property> -->
			</bean>
		</constructor-arg>
		<constructor-arg name="cacheConfigurations" ref="cacheConfigurations" />
		<constructor-arg name="enableStats" value="false" />
		<constructor-arg name="statsPath" value="${bonita.home}/server/" />
		<constructor-arg name="statsPrintInterval" value="10000" />
	</bean>

</beans>
